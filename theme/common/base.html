<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/app.css">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32.png">

    {{ if .IsSingular }}
    <title>{{.Post.Title}} | {{.Site.Title}}</title>
    {{ else }}
    <title>{{.Site.Title}}</title>
    {{ end }}

    <meta name="description" content="{{.Site.Description}}">

    <!-- Google / Search Engine Tags -->
    <meta itemprop="name" content="{{ .Site.Title }}">
    <meta itemprop="description" content="{{ .Site.Description }}">
    <meta itemprop="image" content="/img/og-image.webp">

    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="{{ .Site.BaseURL }}">
    <meta property="og:type" content="website">
    <meta property="og:title" content="{{ .Site.Title }}">
    <meta property="og:description" content="{{ .Site.Description }}">
    <meta property="og:image" content="/img/og-image.webp">

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ .Site.Title }}">
    <meta name="twitter:description" content="{{ .Site.Description }}">
    <meta name="twitter:image" content="/img/og-image.webp">

    {{template "extra_head" .}}
  </head>

  <body>
    <div class="_giraffe">
      <div class="site-header">
        <a href="/">> thien.dev</a>
      </div>

      {{template "content" .}}

      <footer class="site-footer">
        <div>Code is poetry</div>
        <nav>
          <a href="/tags/index.html">tags</a>
          <a href="/rss.xml">rss</a>
          <a href="https://12bit.vn" target="_blank">12bit.vn</a>
          <a href="https://github.com/tatthien/giraffe" target="_blank">giraffe</a>
        </nav>
        <!-- <div class="theme-switcher">
          <label for="theme">
            <svg xmlns="http://www.w3.org/2000/svg" class="theme-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
            </svg>
            <select id="theme" onchange="setTheme(this.value)">
              <option value="system">System</option>
              <option value="light">Light</option>
              <option value="dark">Dark</option>
            </select>
          </label>
        </div> -->
      </footer>
    </div>

    {{template "extra_footer" .}}
    <script src="https://unpkg.com/quicklink@2.2.0/dist/quicklink.umd.js"></script>
    <script>
      quicklink.listen()
    </script>

    <script>
      const selectElm = document.querySelector('select[id="theme"]')
      const themeIconPath = document.querySelector('.theme-icon path')
      
      const handler = {
        get(target, prop, receiver) {
          return Reflect.get(...arguments)
        },
        set(target, prop, value, receiver) {
          if (prop === 'theme' && ['system', 'light', 'dark'].includes(value)) {
            document.documentElement.setAttribute('data-theme', value)

            // Change icon
            switch(value) {
              case 'system':
                themeIconPath.setAttribute('d', 'M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z')
                break
              case 'light':
                themeIconPath.setAttribute('d', 'M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z')
                break
              case 'dark':
                themeIconPath.setAttribute('d', 'M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z')
                break
            }
          }
          
          return Reflect.set(...arguments)
        }
      }

      const reactive = new Proxy({
        theme: 'system',
      }, handler)

      reactive.theme = localStorage.getItem('theme') || 'system'
      selectElm.value = reactive.theme

      function setTheme(theme) {
        localStorage.setItem('theme', theme)
        reactive.theme = theme
      }
    </script>
  </body>

</html>
